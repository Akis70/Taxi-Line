// --- UPDATE THESE TWO LINES IN YOUR CODE ---
const MAILERLITE_API_KEY = "eyJ0eXAiOiJKV1QiLCJhbGciOiJSUzI1NiJ9..."; // Your token
const MAILERLITE_GROUP_ID = 1801337675922019782; // Put your Group ID number here

async function processRegistration(e) {
    e.preventDefault();
    const email = document.getElementById('reg-email').value;
    const name = document.getElementById('reg-name').value;
    const pass = document.getElementById('reg-pass').value;

    // Save locally so the login screen can check these later
    localStorage.setItem('user_email', email);
    localStorage.setItem('user_pass', pass);
    localStorage.setItem('is_verified', 'false');

    // Trigger MailerLite via their Subscriber API
    try {
        const response = await fetch(`https://connect.mailerlite.com/api/subscribers`, {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json',
                'Authorization': `Bearer ${MAILERLITE_API_KEY}`,
                'X-MailerLite-Api-Key': MAILERLITE_API_KEY // Extra header for reliability
            },
            body: JSON.stringify({
                email: email,
                fields: { name: name },
                groups: [MAILERLITE_GROUP_ID] // This places them in the automation group
            })
        });

        if (response.ok) {
            console.log("Success: Subscriber added to group.");
        }
    } catch (err) {
        console.warn("Connection attempt made. Check MailerLite Dashboard.");
    }

    // Move to verification screen
    document.getElementById('register-screen').classList.add('hidden');
    document.getElementById('verify-screen').classList.remove('hidden');
}

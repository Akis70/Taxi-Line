<script>
        const firebaseConfig = {
            apiKey: "AIzaSyCCzXoeqv3VODlSH6j3HrqI36ixYYdEjjI",
            authDomain: "taxi-line-f149e.firebaseapp.com",
            databaseURL: "https://taxi-line-f149e-default-rtdb.europe-west1.firebasedatabase.app",
            projectId: "taxi-line-f149e",
            storageBucket: "taxi-line-f149e.firebasestorage.app",
            messagingSenderId: "1086896421565",
            appId: "1:1086896421565:web:e498b8916fd95a04e7d5d4"
        };

        firebase.initializeApp(firebaseConfig);
        const auth = firebase.auth();
        const database = firebase.database();

        let selectedRole = 'passenger';

        function setRole(role) {
            selectedRole = role;
            document.getElementById('btn-passenger').classList.toggle('active', role === 'passenger');
            document.getElementById('btn-driver').classList.toggle('active', role === 'driver');
            document.getElementById('driver-fields').style.display = (role === 'driver') ? 'block' : 'none';
        }

        function register() {
            const email = document.getElementById('email').value;
            const password = document.getElementById('password').value;
            const phone = document.getElementById('phone').value;
            const taxiNum = document.getElementById('taxi-number').value;

            if (email === "" || password.length < 6 || phone === "") {
                alert("Παρακαλώ συμπληρώστε όλα τα στοιχεία σωστά (Κωδικός 6+ χαρακτήρες).");
                return;
            }

            // 1. Δημιουργία Χρήστη
            auth.createUserWithEmailAndPassword(email, password)
            .then((userCredential) => {
                const user = userCredential.user;

                // 2. Αποστολή Email Επιβεβαίωσης
                return user.sendEmailVerification().then(() => {
                    // 3. Αποθήκευση στη Realtime Database
                    return database.ref('users/' + user.uid).set({
                        email: email,
                        phone: phone,
                        role: selectedRole,
                        taxiNumber: selectedRole === 'driver' ? taxiNum : null,
                        uid: user.uid,
                        createdAt: firebase.database.ServerValue.TIMESTAMP
                    });
                });
            })
            .then(() => {
                alert("Επιτυχής εγγραφή! Σας στείλαμε email επιβεβαίωσης. Παρακαλούμε πατήστε το link στο email σας πριν συνδεθείτε.");
                // Μετά την εγγραφή τους στέλνουμε στο login (index.html) 
                // γιατί δεν μπορούν να μπουν στο dashboard αν δεν επιβεβαιώσουν το email
                window.location.href = "index.html";
            })
            .catch((error) => {
                alert("Σφάλμα: " + error.message);
            });
        }
    </script>

<!DOCTYPE html>
<html lang="el">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Taxi-Line | Î•Î³Î³ÏÎ±Ï†Î®</title>
    <style>
        body { font-family: sans-serif; background: #f4f4f4; display: flex; justify-content: center; align-items: center; height: 100vh; margin: 0; }
        .signup-container { background: white; padding: 30px; border-radius: 10px; box-shadow: 0 4px 10px rgba(0,0,0,0.1); width: 100%; max-width: 400px; text-align: center; }
        input, select { width: 100%; padding: 10px; margin: 10px 0; border: 1px solid #ccc; border-radius: 5px; box-sizing: border-box; }
        .btn { width: 100%; padding: 12px; border: none; border-radius: 5px; cursor: pointer; font-weight: bold; transition: 0.3s; }
        .btn-register { background: #ffcc00; color: black; }
        .btn-register:hover { background: #e6b800; }
        .role-selector { display: flex; gap: 10px; margin-bottom: 10px; }
        .role-btn { flex: 1; padding: 10px; border: 1px solid #ccc; cursor: pointer; border-radius: 5px; background: #eee; }
        .role-btn.active { background: #ffcc00; border-color: #333; }
    </style>
</head>
<body>

    <div class="signup-container">
        <h2>ğŸš• Î”Î·Î¼Î¹Î¿Ï…ÏÎ³Î¯Î± Î›Î¿Î³Î±ÏÎ¹Î±ÏƒÎ¼Î¿Ï</h2>
        
        <div class="role-selector">
            <div id="btn-passenger" class="role-btn active" onclick="setRole('passenger')">Î•Ï€Î¹Î²Î¬Ï„Î·Ï‚</div>
            <div id="btn-driver" class="role-btn" onclick="setRole('driver')">ÎŸÎ´Î·Î³ÏŒÏ‚</div>
        </div>

        <input type="tel" id="phone" placeholder="Î¤Î·Î»Î­Ï†Ï‰Î½Î¿ ÎµÏ€Î¹ÎºÎ¿Î¹Î½Ï‰Î½Î¯Î±Ï‚" required>
        <input type="email" id="email" placeholder="Email" required>
        <input type="password" id="password" placeholder="ÎšÏ‰Î´Î¹ÎºÏŒÏ‚ (6+ Ï‡Î±ÏÎ±ÎºÏ„Î®ÏÎµÏ‚)" required>
        
        <div id="driver-fields" style="display: none;">
            <input type="text" id="taxi-number" placeholder="Î‘ÏÎ¹Î¸Î¼ÏŒÏ‚ Î¤Î±Î¾Î¯ (Ï€.Ï‡. 28)">
        </div>

        <button class="btn btn-register" onclick="register()">Î•Î³Î³ÏÎ±Ï†Î® & Î£ÏÎ½Î´ÎµÏƒÎ·</button>
        <p>ÎˆÏ‡ÎµÏ„Îµ Î®Î´Î· Î»Î¿Î³Î±ÏÎ¹Î±ÏƒÎ¼ÏŒ; <a href="index.html">Î£ÏÎ½Î´ÎµÏƒÎ·</a></p>
    </div>

    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-database-compat.js"></script>

    <script>
        const firebaseConfig = {
            apiKey: "AIzaSyCCzXoeqv3VODlSH6j3HrqI36ixYYdEjjI",
            authDomain: "taxi-line-f149e.firebaseapp.com",
            databaseURL: "https://taxi-line-f149e-default-rtdb.europe-west1.firebasedatabase.app",
            projectId: "taxi-line-f149e",
            storageBucket: "taxi-line-f149e.firebasestorage.app",
            messagingSenderId: "1086896421565",
            appId: "1:1086896421565:web:e498b8916fd95a04e7d5d4"
        };

        firebase.initializeApp(firebaseConfig);
        const auth = firebase.auth();
        const database = firebase.database();

        let selectedRole = 'passenger';

        function setRole(role) {
            selectedRole = role;
            document.getElementById('btn-passenger').classList.toggle('active', role === 'passenger');
            document.getElementById('btn-driver').classList.toggle('active', role === 'driver');
            document.getElementById('driver-fields').style.display = (role === 'driver') ? 'block' : 'none';
        }

        function register() {
            const email = document.getElementById('email').value;
            const password = document.getElementById('password').value;
            const phone = document.getElementById('phone').value;
            const taxiNum = document.getElementById('taxi-number').value;

            if (email === "" || password.length < 6 || phone === "") {
                alert("Î Î±ÏÎ±ÎºÎ±Î»Ï ÏƒÏ…Î¼Ï€Î»Î·ÏÏÏƒÏ„Îµ ÏŒÎ»Î± Ï„Î± ÏƒÏ„Î¿Î¹Ï‡ÎµÎ¯Î± ÏƒÏ‰ÏƒÏ„Î¬.");
                return;
            }

            auth.createUserWithEmailAndPassword(email, password)
    .then((userCredential) => {
        const user = userCredential.user;

        // 1. Î‘Î ÎŸÎ£Î¤ÎŸÎ›Î— EMAIL Î•Î Î‘Î›Î—Î˜Î•Î¥Î£Î—Î£
        user.sendEmailVerification().then(() => {
            console.log("Verification email sent.");
        });

        // 2. Î‘Î ÎŸÎ˜Î—ÎšÎ•Î¥Î£Î— Î£Î¤Î— Î’Î‘Î£Î— Î”Î•Î”ÎŸÎœÎ•ÎÎ©Î
        return database.ref('users/' + user.uid).set({
            email: email,
            phone: phone,
            role: selectedRole,
            taxiNumber: selectedRole === 'driver' ? taxiNum : null,
            uid: user.uid,
            createdAt: firebase.database.ServerValue.TIMESTAMP
        });
    })
    .then(() => {
        alert("Î•Ï€Î¹Ï„Ï…Ï‡Î®Ï‚ ÎµÎ³Î³ÏÎ±Ï†Î®! Î£Î±Ï‚ ÏƒÏ„ÎµÎ¯Î»Î±Î¼Îµ Î­Î½Î± email ÎµÏ€Î¹Î²ÎµÎ²Î±Î¯Ï‰ÏƒÎ·Ï‚. Î Î±ÏÎ±ÎºÎ±Î»Î¿ÏÎ¼Îµ ÎµÎ»Î­Î³Î¾Ï„Îµ Ï„Î± ÎµÎ¹ÏƒÎµÏÏ‡ÏŒÎ¼ÎµÎ½Î¬ ÏƒÎ±Ï‚ (ÎºÎ±Î¹ Ï„Î± Spam) Ï€ÏÎ¹Î½ ÏƒÏ…Î½Î´ÎµÎ¸ÎµÎ¯Ï„Îµ.");
        window.location.href = "dashboard.html";
    })
    .catch((error) => alert("Î£Ï†Î¬Î»Î¼Î±: " + error.message));
    </script>
</body>
</html>

<!DOCTYPE html>
<html lang="el">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Taxi-Line | Î•Î³Î³ÏÎ±Ï†Î®</title>
    <style>
        :root { --primary: #f1c40f; --secondary: #2c3e50; --bg: #f4f4f4; }
        body { font-family: 'Segoe UI', sans-serif; background: var(--bg); display: flex; justify-content: center; align-items: center; height: 100vh; margin: 0; }
        .card { background: white; padding: 30px; border-radius: 12px; box-shadow: 0 4px 15px rgba(0,0,0,0.1); width: 100%; max-width: 350px; text-align: center; }
        input, select { width: 100%; padding: 12px; margin: 10px 0; border: 1px solid #ddd; border-radius: 8px; box-sizing: border-box; }
        .btn { background: var(--secondary); color: white; border: none; padding: 15px; width: 100%; border-radius: 8px; cursor: pointer; font-weight: bold; }
        .btn:hover { background: #34495e; }
        .link { display: block; margin-top: 15px; color: #7f8c8d; text-decoration: none; font-size: 14px; }
    </style>
</head>
<body>

    <div class="card">
        <h2 style="color:var(--secondary)">ğŸš• Î•Î³Î³ÏÎ±Ï†Î®</h2>
        <input type="email" id="email" placeholder="Email">
        <input type="password" id="password" placeholder="ÎšÏ‰Î´Î¹ÎºÏŒÏ‚ (6+ Ï‡Î±ÏÎ±ÎºÏ„Î®ÏÎµÏ‚)">
        <input type="tel" id="phone" placeholder="Î¤Î·Î»Î­Ï†Ï‰Î½Î¿ (Ï€.Ï‡. 69...)">
        
        <select id="role" onchange="toggleTaxiInput()">
            <option value="passenger">Î•Ï€Î¹Î²Î¬Ï„Î·Ï‚</option>
            <option value="driver">ÎŸÎ´Î·Î³ÏŒÏ‚ Î¤Î±Î¾Î¯</option>
        </select>

        <input type="text" id="taxi-number" placeholder="Î‘ÏÎ¹Î¸Î¼ÏŒÏ‚ Î¤Î±Î¾Î¯ (Ï€.Ï‡. Î¤Î‘Î-1234)" style="display:none;">

        <button class="btn" onclick="signUp()">Î”Î—ÎœÎ™ÎŸÎ¥Î¡Î“Î™Î‘ Î›ÎŸÎ“Î‘Î¡Î™Î‘Î£ÎœÎŸÎ¥</button>
        <a href="index.html" class="link">ÎˆÏ‡ÎµÏ„Îµ Î®Î´Î· Î»Î¿Î³Î±ÏÎ¹Î±ÏƒÎ¼ÏŒ; Î£ÏÎ½Î´ÎµÏƒÎ·</a>
    </div>

    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-database-compat.js"></script>

    <script>
        const firebaseConfig = {
            apiKey: "AIzaSyCCzXoeqv3VODlSH6j3HrqI36ixYYdEjjI",
            authDomain: "taxi-line-f149e.firebaseapp.com",
            databaseURL: "https://taxi-line-f149e-default-rtdb.europe-west1.firebasedatabase.app",
            projectId: "taxi-line-f149e",
            storageBucket: "taxi-line-f149e.firebasestorage.app",
            messagingSenderId: "1086896421565",
            appId: "1:1086896421565:web:e498b8916fd95a04e7d5d4"
        };

        firebase.initializeApp(firebaseConfig);
        const auth = firebase.auth();
        const database = firebase.database();

        function toggleTaxiInput() {
            const role = document.getElementById('role').value;
            document.getElementById('taxi-number').style.display = (role === 'driver') ? 'block' : 'none';
        }

        async function signUp() {
            const email = document.getElementById('email').value;
            const password = document.getElementById('password').value;
            const phone = document.getElementById('phone').value;
            const role = document.getElementById('role').value;
            const taxiNum = document.getElementById('taxi-number').value;

            if (!email || password.length < 6 || !phone) {
                alert("Î£Ï…Î¼Ï€Î»Î·ÏÏÏƒÏ„Îµ ÏŒÎ»Î± Ï„Î± Ï€ÎµÎ´Î¯Î± ÏƒÏ‰ÏƒÏ„Î¬!");
                return;
            }

            try {
                const userCredential = await auth.createUserWithEmailAndPassword(email, password);
                const user = userCredential.user;

                // Î‘Ï€Î¿ÏƒÏ„Î¿Î»Î® Email Verification
                await user.sendEmailVerification();
                alert("ÎŸ Î»Î¿Î³Î±ÏÎ¹Î±ÏƒÎ¼ÏŒÏ‚ Î´Î·Î¼Î¹Î¿Ï…ÏÎ³Î®Î¸Î·ÎºÎµ! Î Î±ÏÎ±ÎºÎ±Î»Ï ÎµÎ»Î­Î³Î¾Ï„Îµ Ï„Î¿ email ÏƒÎ±Ï‚ Î³Î¹Î± ÎµÏ€Î¹Î²ÎµÎ²Î±Î¯Ï‰ÏƒÎ· Ï€ÏÎ¹Î½ ÏƒÏ…Î½Î´ÎµÎ¸ÎµÎ¯Ï„Îµ.");

                // Î‘Ï€Î¿Î¸Î®ÎºÎµÏ…ÏƒÎ· ÏƒÏ„Î¿ Realtime Database
                await database.ref('users/' + user.uid).set({
                    email: email,
                    phone: phone,
                    role: role,
                    taxiNumber: (role === 'driver') ? taxiNum : null,
                    uid: user.uid
                });

                // Î‘Ï€Î¿ÏƒÏÎ½Î´ÎµÏƒÎ· Î³Î¹Î± Î½Î± Î±Î½Î±Î³ÎºÎ¬ÏƒÎ¿Ï…Î¼Îµ Ï„Î¿ Verification
                await auth.signOut();
                window.location.href = "index.html";

            } catch (error) {
                alert("Î£Ï†Î¬Î»Î¼Î±: " + error.message);
            }
        }
    </script>
</body>
</html>
